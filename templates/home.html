<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>THREADLINE — Custom T-Shirts</title>
<link href="https://fonts.googleapis.com/css2?family=Bebas+Neue&family=DM+Sans:ital,wght@0,300;0,400;0,500;0,700;1,300&display=swap" rel="stylesheet">
<style>
  :root{--orange:#FF6B00;--dark:#0A0A0A;--card-bg:#141414;--text:#F0EDE8;--muted:#777;--border:rgba(255,255,255,0.07);}
  *,*::before,*::after{box-sizing:border-box;margin:0;padding:0;}
  html{scroll-behavior:smooth;}
  body{font-family:'DM Sans',sans-serif;background:var(--dark);color:var(--text);min-height:100vh;overflow-x:hidden;}

  /* NAV */
  nav{position:fixed;top:0;left:0;right:0;z-index:200;display:flex;justify-content:space-between;align-items:center;padding:22px 48px;background:linear-gradient(to bottom,rgba(10,10,10,.97),transparent);}
  .nav-logo{font-family:'Bebas Neue',sans-serif;font-size:1.9rem;letter-spacing:.1em;color:var(--text);text-decoration:none;}
  .nav-logo span{color:var(--orange);}
  .nav-right{display:flex;align-items:center;gap:10px;}
  .nav-btn{background:transparent;color:var(--text);border:1px solid rgba(255,255,255,.2);padding:9px 22px;text-decoration:none;font-size:.72rem;letter-spacing:.18em;text-transform:uppercase;font-weight:600;border-radius:2px;transition:all .25s;}
  .nav-btn:hover{background:rgba(255,255,255,.06);border-color:rgba(255,255,255,.4);}
  .nav-btn.primary{background:var(--orange);border-color:var(--orange);color:#000;}
  .nav-btn.primary:hover{background:#ff7d1a;}

  /* HERO */
  .hero{height:100vh;display:flex;flex-direction:column;justify-content:center;align-items:center;text-align:center;position:relative;overflow:hidden;}
  .hero-bg{position:absolute;inset:0;background:radial-gradient(ellipse 70% 60% at 50% 65%,rgba(255,107,0,.14),transparent 70%),#0A0A0A;}
  .hero-grid{position:absolute;inset:0;background-image:linear-gradient(rgba(255,255,255,.03) 1px,transparent 1px),linear-gradient(90deg,rgba(255,255,255,.03) 1px,transparent 1px);background-size:80px 80px;mask-image:radial-gradient(ellipse 70% 70% at 50% 50%,black,transparent);}
  .hero-content{position:relative;z-index:2;animation:heroIn 1.1s cubic-bezier(.16,1,.3,1) forwards;}
  @keyframes heroIn{from{opacity:0;transform:translateY(40px)}to{opacity:1;transform:translateY(0)}}
  .hero-tag{display:inline-block;background:var(--orange);color:#000;font-size:.68rem;letter-spacing:.28em;text-transform:uppercase;font-weight:700;padding:7px 18px;border-radius:2px;margin-bottom:30px;}
  .hero h1{font-family:'Bebas Neue',sans-serif;font-size:clamp(5.5rem,16vw,14rem);line-height:.85;letter-spacing:.015em;margin-bottom:28px;}
  .hero h1 .accent{color:var(--orange);text-shadow:0 0 100px rgba(255,107,0,.45);}
  .hero-sub{font-size:1rem;color:var(--muted);letter-spacing:.06em;font-weight:300;margin-bottom:48px;}
  .hero-cta{display:inline-flex;align-items:center;gap:12px;background:var(--orange);color:#000;text-decoration:none;font-weight:700;font-size:.82rem;letter-spacing:.14em;text-transform:uppercase;padding:17px 40px;border-radius:3px;transition:all .3s;box-shadow:0 0 50px rgba(255,107,0,.35);}
  .hero-cta:hover{transform:translateY(-3px);box-shadow:0 8px 60px rgba(255,107,0,.55);background:#ff7d1a;}
  .scroll-ind{position:absolute;bottom:36px;left:50%;transform:translateX(-50%);z-index:2;display:flex;flex-direction:column;align-items:center;gap:8px;color:var(--muted);font-size:.68rem;letter-spacing:.22em;text-transform:uppercase;animation:bounce 2.4s ease-in-out infinite;}
  @keyframes bounce{0%,100%{transform:translateX(-50%) translateY(0)}50%{transform:translateX(-50%) translateY(10px)}}

  /* CATALOG */
  .catalog{padding:110px 48px 80px;max-width:1380px;margin:0 auto;}
  .section-hd{display:flex;justify-content:space-between;align-items:flex-end;margin-bottom:56px;padding-bottom:28px;border-bottom:1px solid var(--border);}
  .section-title{font-family:'Bebas Neue',sans-serif;font-size:clamp(2.4rem,5vw,3.8rem);letter-spacing:.04em;}
  .section-count{color:var(--muted);font-size:.83rem;font-weight:300;}
  .grid{display:grid;grid-template-columns:repeat(auto-fill,minmax(300px,1fr));gap:3px;}

  /* CARD */
  .card{background:var(--card-bg);position:relative;overflow:hidden;transition:transform .4s cubic-bezier(.16,1,.3,1);animation:cardIn .7s cubic-bezier(.16,1,.3,1) both;}
  .card:nth-child(1){animation-delay:.05s}.card:nth-child(2){animation-delay:.12s}.card:nth-child(3){animation-delay:.19s}.card:nth-child(4){animation-delay:.26s}.card:nth-child(5){animation-delay:.33s}.card:nth-child(6){animation-delay:.4s}
  @keyframes cardIn{from{opacity:0;transform:translateY(50px) scale(.97)}to{opacity:1;transform:translateY(0) scale(1)}}
  .card:hover{transform:translateY(-4px);z-index:2;}

  /* ── CAROUSEL ── */
  .carousel{position:relative;overflow:hidden;aspect-ratio:4/5;}
  .carousel-track{display:flex;height:100%;transition:transform .45s cubic-bezier(.16,1,.3,1);will-change:transform;}
  .carousel-slide{min-width:100%;height:100%;position:relative;flex-shrink:0;}
  .carousel-slide img{width:100%;height:100%;object-fit:cover;display:block;}

  /* Gradient overlay */
  .card-overlay{position:absolute;inset:0;background:linear-gradient(to top,rgba(0,0,0,.9) 0%,rgba(0,0,0,.15) 45%,transparent 70%);z-index:1;pointer-events:none;}

  /* Badges */
  .card-badge{position:absolute;top:14px;left:14px;z-index:5;font-size:.63rem;letter-spacing:.22em;text-transform:uppercase;font-weight:700;padding:5px 13px;border-radius:2px;}
  .in-stock{background:var(--orange);color:#000;}
  .out-stock{background:rgba(255,255,255,.12);color:var(--text);backdrop-filter:blur(10px);}
  .stock-pill{position:absolute;top:14px;right:14px;z-index:5;font-size:.6rem;letter-spacing:.1em;text-transform:uppercase;font-weight:700;padding:4px 10px;border-radius:2px;background:rgba(0,0,0,.6);color:var(--muted);backdrop-filter:blur(8px);}

  /* Arrow buttons */
  .carousel-btn{position:absolute;top:50%;transform:translateY(-50%);z-index:6;width:36px;height:36px;border-radius:50%;background:rgba(0,0,0,.55);border:1px solid rgba(255,255,255,.12);backdrop-filter:blur(8px);color:#fff;cursor:pointer;display:flex;align-items:center;justify-content:center;transition:all .2s;opacity:0;}
  .carousel:hover .carousel-btn{opacity:1;}
  .carousel-btn:hover{background:var(--orange);border-color:var(--orange);}
  .carousel-btn.prev{left:10px;}
  .carousel-btn.next{right:10px;}
  /* Always show on touch devices */
  @media(hover:none){.carousel-btn{opacity:1;}}

  /* Dot indicators */
  .carousel-dots{position:absolute;bottom:12px;left:50%;transform:translateX(-50%);z-index:6;display:flex;gap:5px;align-items:center;}
  .dot{width:5px;height:5px;border-radius:50%;background:rgba(255,255,255,.3);transition:all .25s;cursor:pointer;}
  .dot.active{background:#fff;width:16px;border-radius:3px;}

  /* Slide counter */
  .slide-counter{position:absolute;bottom:12px;right:14px;z-index:6;font-size:.62rem;color:rgba(255,255,255,.5);letter-spacing:.08em;}

  /* Card hover info */
  .card-info{position:absolute;bottom:0;left:0;right:0;z-index:2;padding:24px;transform:translateY(60px);transition:transform .45s cubic-bezier(.16,1,.3,1);}
  .card:hover .card-info{transform:translateY(0);}
  .card-code{font-size:.62rem;letter-spacing:.28em;text-transform:uppercase;color:var(--orange);font-weight:700;margin-bottom:5px;}
  .card-name-big{font-family:'Bebas Neue',sans-serif;font-size:1.7rem;letter-spacing:.04em;margin-bottom:6px;}
  .card-desc{font-size:.8rem;color:rgba(240,237,232,.6);line-height:1.55;font-weight:300;margin-bottom:18px;}
  .card-foot{display:flex;justify-content:space-between;align-items:center;}
  .card-price-big{font-family:'Bebas Neue',sans-serif;font-size:2rem;color:var(--orange);}
  .order-btn{display:inline-flex;align-items:center;gap:7px;background:var(--orange);color:#000;text-decoration:none;font-size:.72rem;font-weight:700;letter-spacing:.15em;text-transform:uppercase;padding:10px 18px;border-radius:2px;transition:all .25s;}
  .order-btn:hover{background:#ff7d1a;transform:scale(1.06);}
  .sold-out-label{font-size:.72rem;letter-spacing:.15em;text-transform:uppercase;color:var(--muted);}

  /* Static card footer */
  .card-static{padding:18px 22px 22px;border-top:1px solid var(--border);}
  .card-static-name{font-family:'Bebas Neue',sans-serif;font-size:1.25rem;letter-spacing:.04em;margin-bottom:2px;}
  .card-static-price{font-family:'Bebas Neue',sans-serif;font-size:1.45rem;color:var(--orange);}
  .card-static-imgs{font-size:.65rem;color:var(--muted);margin-top:2px;letter-spacing:.08em;}

  /* Empty state */
  .empty{grid-column:1/-1;text-align:center;padding:120px 20px;color:var(--muted);}

  /* WhatsApp button */
  .wa-btn{position:fixed;bottom:28px;right:28px;z-index:500;display:flex;align-items:center;gap:10px;background:#25D366;color:#fff;text-decoration:none;padding:13px 20px;border-radius:50px;font-size:.82rem;font-weight:700;letter-spacing:.04em;box-shadow:0 4px 24px rgba(37,211,102,.4);transition:all .3s;animation:waPop .6s cubic-bezier(.34,1.56,.64,1) 1.5s both;}
  .wa-btn:hover{background:#20bd5a;transform:translateY(-3px);box-shadow:0 8px 32px rgba(37,211,102,.55);}
  @keyframes waPop{from{opacity:0;transform:scale(0) translateY(20px)}to{opacity:1;transform:scale(1) translateY(0)}}

  footer{border-top:1px solid var(--border);padding:36px 48px;display:flex;justify-content:space-between;align-items:center;flex-wrap:wrap;gap:14px;color:var(--muted);font-size:.78rem;letter-spacing:.06em;}
  .f-logo{font-family:'Bebas Neue',sans-serif;font-size:1.4rem;color:var(--text);letter-spacing:.1em;}
  .f-logo span{color:var(--orange);}
  .f-links{display:flex;gap:24px;}
  .f-links a{color:var(--muted);text-decoration:none;transition:color .2s;}
  .f-links a:hover{color:var(--orange);}

  @media(max-width:768px){nav{padding:18px 20px}.catalog{padding:80px 16px 60px}.section-hd{flex-direction:column;align-items:flex-start;gap:8px}.grid{grid-template-columns:repeat(2,1fr);gap:2px}footer{flex-direction:column;gap:12px;text-align:center;padding:28px 20px}}
  @media(max-width:480px){.grid{grid-template-columns:1fr}.nav-btn:not(.primary){display:none}}
</style>
</head>
<body>

<nav>
  <a href="/" class="nav-logo">THREAD<span>LINE</span></a>
  <div class="nav-right">
    <a href="/track" class="nav-btn">Track Order</a>
    <a href="/admin" class="nav-btn primary">Admin ↗</a>
  </div>
</nav>

<section class="hero">
  <div class="hero-bg"></div>
  <div class="hero-grid"></div>
  <div class="hero-content">
    <span class="hero-tag">✦ Custom Prints · Premium Quality ✦</span>
    <h1>WEAR<br><span class="accent">YOUR</span><br>STORY</h1>
    <p class="hero-sub">Unique designs. Real fabric. Delivered to your door.</p>
    <a href="#catalog" class="hero-cta">
      Shop Collection
      <svg width="16" height="16" viewBox="0 0 16 16" fill="none"><path d="M3 8H13M13 8L9 4M13 8L9 12" stroke="currentColor" stroke-width="1.8" stroke-linecap="round" stroke-linejoin="round"/></svg>
    </a>
  </div>
  <div class="scroll-ind">
    <svg width="18" height="18" viewBox="0 0 18 18" fill="none"><path d="M9 2v14M9 16L3 10M9 16L15 10" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/></svg>
    Scroll
  </div>
</section>

<section class="catalog" id="catalog">
  <div class="section-hd">
    <h2 class="section-title">Our Collection</h2>
    <span class="section-count">{{ designs|length }} Design{% if designs|length != 1 %}s{% endif %}</span>
  </div>
  <div class="grid">
    {% for d in designs %}
    {% set imgs = d.images if d.images else [] %}
    <div class="card">

      <!-- ── CAROUSEL ── -->
      <div class="carousel" id="carousel-{{ d.id }}" data-index="0" data-total="{{ imgs|length if imgs|length > 0 else 1 }}">

        <div class="carousel-track" id="track-{{ d.id }}">
          {% if imgs %}
            {% for img in imgs %}
            <div class="carousel-slide">
              <img src="/static/uploads/{{ img.filename }}" alt="{{ d.name }} photo {{ loop.index }}" loading="{% if loop.first %}eager{% else %}lazy{% endif %}">
            </div>
            {% endfor %}
          {% else %}
            <div class="carousel-slide">
              <img src="/static/uploads/{{ d.image }}" alt="{{ d.name }}">
            </div>
          {% endif %}
        </div>

        <!-- Overlay (for text hover) -->
        <div class="card-overlay"></div>

        <!-- Stock badge -->
        <span class="card-badge {% if d.stock == 'In Stock' %}in-stock{% else %}out-stock{% endif %}">{{ d.stock }}</span>
        {% if d.stock == 'In Stock' %}<span class="stock-pill">{{ d.stock_quantity }} left</span>{% endif %}

        <!-- Arrows (only if more than 1 image) -->
        {% if imgs|length > 1 %}
        <button class="carousel-btn prev" onclick="slide('{{ d.id }}', -1)" aria-label="Previous">
          <svg width="14" height="14" viewBox="0 0 14 14" fill="none"><path d="M9 2L4 7l5 5" stroke="currentColor" stroke-width="1.8" stroke-linecap="round" stroke-linejoin="round"/></svg>
        </button>
        <button class="carousel-btn next" onclick="slide('{{ d.id }}', 1)" aria-label="Next">
          <svg width="14" height="14" viewBox="0 0 14 14" fill="none"><path d="M5 2l5 5-5 5" stroke="currentColor" stroke-width="1.8" stroke-linecap="round" stroke-linejoin="round"/></svg>
        </button>

        <!-- Dots -->
        <div class="carousel-dots" id="dots-{{ d.id }}">
          {% for img in imgs %}
          <span class="dot {% if loop.first %}active{% endif %}" onclick="goTo('{{ d.id }}', {{ loop.index0 }})"></span>
          {% endfor %}
        </div>

        <!-- Counter -->
        <span class="slide-counter" id="counter-{{ d.id }}">1 / {{ imgs|length }}</span>
        {% endif %}

        <!-- Hover info overlay -->
        <div class="card-info">
          <p class="card-code">#{{ d.design_code }}</p>
          <h3 class="card-name-big">{{ d.name }}</h3>
          <p class="card-desc">{{ d.description }}</p>
          <div class="card-foot">
            <span class="card-price-big">₹{{ d.price }}</span>
            {% if d.stock == "In Stock" %}
              <a class="order-btn" href="/order/{{ d.design_code }}">Order →</a>
            {% else %}
              <span class="sold-out-label">Sold Out</span>
            {% endif %}
          </div>
        </div>

      </div><!-- /carousel -->

      <!-- Static footer visible always -->
      <div class="card-static">
        <p class="card-code">#{{ d.design_code }}</p>
        <h3 class="card-static-name">{{ d.name }}</h3>
        <span class="card-static-price">₹{{ d.price }}</span>
        {% if imgs|length > 1 %}
        <p class="card-static-imgs">{{ imgs|length }} photos</p>
        {% endif %}
      </div>

    </div>
    {% else %}
    <div class="empty">
      <svg width="60" height="60" viewBox="0 0 60 60" fill="none"><circle cx="30" cy="30" r="28" stroke="currentColor" stroke-width="1.5"/><path d="M20 30h20M30 20v20" stroke="currentColor" stroke-width="1.5" stroke-linecap="round"/></svg>
      <p style="margin-top:20px">No designs yet — check back soon!</p>
    </div>
    {% endfor %}
  </div>
</section>

<footer>
  <div class="f-logo">THREAD<span>LINE</span></div>
  <span>© 2025 Custom T-Shirt Store. All Rights Reserved.</span>
</footer>

{% if settings and settings.admin_whatsapp %}
<a class="wa-btn" href="https://wa.me/{{ settings.admin_whatsapp }}?text=Hi!%20I%20have%20a%20question%20about%20THREADLINE." target="_blank" rel="noopener">
  <svg width="20" height="20" viewBox="0 0 24 24" fill="currentColor"><path d="M17.472 14.382c-.297-.149-1.758-.867-2.03-.967-.273-.099-.471-.148-.67.15-.197.297-.767.966-.94 1.164-.173.199-.347.223-.644.075-.297-.15-1.255-.463-2.39-1.475-.883-.788-1.48-1.761-1.653-2.059-.173-.297-.018-.458.13-.606.134-.133.298-.347.446-.52.149-.174.198-.298.298-.497.099-.198.05-.371-.025-.52-.075-.149-.669-1.612-.916-2.207-.242-.579-.487-.5-.669-.51-.173-.008-.371-.01-.57-.01-.198 0-.52.074-.792.372-.272.297-1.04 1.016-1.04 2.479 0 1.462 1.065 2.875 1.213 3.074.149.198 2.096 3.2 5.077 4.487.709.306 1.262.489 1.694.625.712.227 1.36.195 1.871.118.571-.085 1.758-.719 2.006-1.413.248-.694.248-1.289.173-1.413-.074-.124-.272-.198-.57-.347z"/><path d="M12 0C5.373 0 0 5.373 0 12c0 2.115.554 4.103 1.523 5.824L.057 23.5a.5.5 0 00.611.61l5.79-1.516A11.95 11.95 0 0012 24c6.627 0 12-5.373 12-12S18.627 0 12 0zm0 22c-1.886 0-3.655-.51-5.176-1.402l-.36-.214-3.795.994.994-3.693-.235-.375A9.96 9.96 0 012 12C2 6.477 6.477 2 12 2s10 4.477 10 10-4.477 10-10 10z"/></svg>
  Chat with us
</a>
{% endif %}

<script>
// ── Carousel state ──────────────────────────────────────────────────────────
const state = {};

function slide(designId, direction) {
  const carousel = document.getElementById('carousel-' + designId);
  const total    = parseInt(carousel.dataset.total);
  if (total <= 1) return;

  if (!state[designId]) state[designId] = 0;
  state[designId] = (state[designId] + direction + total) % total;
  updateCarousel(designId);
}

function goTo(designId, index) {
  state[designId] = index;
  updateCarousel(designId);
}

function updateCarousel(designId) {
  const idx   = state[designId] || 0;
  const track = document.getElementById('track-' + designId);
  const dots  = document.getElementById('dots-' + designId);
  const counter = document.getElementById('counter-' + designId);
  const total = parseInt(document.getElementById('carousel-' + designId).dataset.total);

  // Move track
  track.style.transform = `translateX(-${idx * 100}%)`;

  // Update dots
  if (dots) {
    dots.querySelectorAll('.dot').forEach((dot, i) => {
      dot.classList.toggle('active', i === idx);
    });
  }

  // Update counter
  if (counter) counter.textContent = `${idx + 1} / ${total}`;
}

// ── Touch/swipe support ─────────────────────────────────────────────────────
document.querySelectorAll('.carousel').forEach(carousel => {
  let startX = 0;
  const id = carousel.id.replace('carousel-', '');

  carousel.addEventListener('touchstart', e => {
    startX = e.touches[0].clientX;
  }, { passive: true });

  carousel.addEventListener('touchend', e => {
    const diff = startX - e.changedTouches[0].clientX;
    if (Math.abs(diff) > 40) slide(id, diff > 0 ? 1 : -1);
  }, { passive: true });
});
</script>
</body>
</html>
